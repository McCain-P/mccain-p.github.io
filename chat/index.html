<html>
  <head>
    <title>
      NetCom
    </title>
    <style>
      body {
        background-color: RGB(0,0,0); 
      }
      body * {
        padding: 0;
        border: 0;
        margin: 0;
        outline: none;
      }
      button {
        border-radius: 12.5%;
        border-style: solid;
        border-width: 0.3vw;
        color: RGB(255,255,255);
        font-family: "Arial", sans-serif;
        font-size: 2vw;
        text-align: center;
      }
      button.blue {
        background-color: RGB(0,0,255);
        border-color: RGB(0,0,192);
        box-shadow: 0.3vw 0.3vw 0 0 RGB(0,0,128);
      }
       button.purple {
        background-color: RGB(255,0,255);
        border-color: RGB(192,0,192);
        box-shadow: 0.3vw 0.3vw 0 0 RGB(128,0,128);
      }
      button.black {
        background-color: RGB(0,0,0);
        border-color: RGB(255,255,255);
        box-shadow: 0.3vw 0.3vw 0 0 RGB(128,128,128); 
      }
      button.blue:hover {
        background-color: RGB(128,128,255); 
      }
      button.purple:hover {
        background-color: RGB(255,128,255); 
      }
      button.black:hover {
        background-color: RGB(128,128,128);
      }
      button:active {
        box-shadow: none;
        transform: translate(0.3vw,0.3vw);  
      }
      button.blue:active {
        background-color: RGB(0,0,192);
      }
      button.purple:active {
        background-color: RGB(192,0,192); 
      }
      button.black:active {
        background-color: RGB(64,64,64);
      }
      .icon {
        background-repeat: no-repeat;
        background-size: auto 75%;
        background-origin: content-box;
        background-position: center;
      }
      #header {
        height: 10vh;
        width: 100vw;
        position: fixed;
        top: 0;
        left: 0;
        border-bottom: 2vh solid RGB(0,0,255);
      }
      #footer {
        height: 20vh;
        width: 100vw;
        position: fixed;
        bottom: 0;
        left: 0;
        background-color: RGB(0,0,0);
        border-top: 2vh solid RGB(255,0,255);
      }
      #header * {
        position: absolute; 
      }
      #logo {
        height: 100%;
        top: 0;
        left: 1%;
      }
      #chatKeyPreface {
        top: 50%;
        left: 30%;
        transform: translateY(-50%);
        color: RGB(255,255,255);
        font-family: "Arial", sans-serif;
        font-size: 2vw;
      }
      #chatKeyInput {
        width: 10%;
        top: 50%;
        left: 40%;
        transform: translateY(-50%);
        background-color: RGBA(0,0,0,0);
        border: 0.3vw solid RGB(255,255,255);
        color: RGB(255,255,255);
        font-family: "Arial", sans-serif;
        font-size: 1vw;
      }
      #connectChat {
        width: 7.5%;
        height: 50%;
        top: 25%;
        left: 52.5%;
        font-size: 1.5vw;
      }
      #createChat {
        width: 7.5%;
        height: 50%;
        top: 25%;
        left: 62.5%;
        font-size: 1.5vw;
      }
      #setUsername {
        width: 7.5%;
        height: 50%;
        top: 25%;
        right: 20%;
        font-size: 1.5vw;
      }
      #usernameInput {
        width: 15%;
        top: 50%;
        right: 2.5%;
        transform: translateY(-50%);
        background-color: RGBA(0,0,0,0);
        border: 0.5vw solid RGB(255,255,255);
        color: RGB(255,255,255);
        font-family: "Arial", sans-serif;
        font-size: 2vw;
      }
      #headerBackground {
        height: 10vh;
        width: 100vw;
        position: fixed;
        top: 0;
        left: 0;
        background-color: RGB(0,0,0);
        border-bottom: 2vh solid RGB(0,0,255);
        z-index: -1;
      }
      #createChatDropdown {
        height: 100%;
        width: 35%;
        right: 10%;
        top: 0;
        background-color: RGB(0,0,0);
        border: 0.5vw solid RGB(255,255,255);
        border-top: none;
        z-index: -2;
      }
      @keyframes createChatDropdown {
        from {
          top: 0;
        }
        to {
          top: calc(100% + 2vh);
        }
      }
      @keyframes createChatRiseup {
        from {
          top: calc(100% + 2vh);
        }
        50% {
          top: calc(100% + 2vh);
        }
        to {
          top: 0;
        }
      }
      #createChat:active ~ #createChatDropdown, #createChat ~ #createChatDropdown:hover {
        animation: 0.5s linear 0s 1 normal forwards running createChatDropdown;
      }
      #createChat:not(:active) ~ #createChatDropdown:not(:hover) {
        animation: 1s linear 0s 1 normal forwards running createChatRiseup;
      }
      #keyPhrasePreface {
        
      }
      #keyPhraseInput {
        
      }
      #keyPhraseCreateButton {
        
      }
      #footer * {
        position: absolute;
      }
      #messageInput {
        height: 75%;
        width: 55%;
        top: 50%;
        left: 50%;
        transform: translate(-50%,-50%);
        border: 1vh solid RGB(255,0,255);
      }
      #textInput {
        height: 60%;
        width: 100%;
        top: 0;
        left: 0;
        background-color: RGBA(0,0,0,0);
        color: RGB(255,255,255);
        font-family: "Arial", sans-serif;
        font-size: 1vw;
        overflow-wrap: break-word;
        word-break: break-word;
        overflow-y: auto;
        resize: none;
      }
      #fileInput {
        height: calc(40% - 1vh);
        width: 100%;
        bottom: 0;
        left: 0;
        border-top: 1vh solid RGB(255,0,255);
      }
      #fileSelect {
        height: 80%;
        width: 8%;
        top: 10%;
        left: 2%;
        background-image: URL(resources/fileIcon.svg);
      }
      #fileNames {
        width: 85%;
        top: 50%;
        right: 0;
        transform: translateY(-50%);
        text-align: left;
        color: RGB(255,255,255);
        font-family: "Arial", sans-serif;
        font-size: 1vw;
      }
      #fileInputElement {
        display: none; 
      }
      #messageSend {
        height: 25%;
        width: 10%;
        top: 37.5%;
        right: 5%;
      }
      #chat {
        height: 66vh;
        width: 100vw;
        position: fixed; 
        top: 12vh;
        left: 0;
        padding-left: 10vw;
        padding-right: 10vw;
        overflow-y: scroll;
      }
      #chat > * {
        position: relative;
        margin-top: 5vh;
        margin-bottom: 5vh;
      }
      #chat > p {
        color: RGB(255,255,255);
        font-family: "Arial", sans-serif;
        font-size: 1vw;
        overflow-wrap: break-word;
        word-break: break-word;
      }
      .media {
        height: 22vh;
        width: 16.5vh;
        border-style: solid;
        border-width: 0.5vw;
        border-color: RGB(0,0,255);
      }
      .media * {
        position: absolute; 
      }
      .mediaContent {
        height: 75%;
        width: 100%;
        top: 0;
        left: 0;
        border: none;
      }
      .mediaControls {
        height: 25%;
        width: 100%;
        bottom: 0;
        left: 0;
        background-color: RGB(0,0,255);
      }
      .mediaControls > button {
        height: 75%;
        width: 18.75%;
        background-size: auto 50%;
      }
      .mediaControls > .downloadButton {
        top: 12.5%;
        right: 5%;
        background-image: URL(resources/fileIcon.svg);
      }
      .mediaControls > .playButton {
        top: 12.5%;
        left: 5%;
        background-image: URL(resources/playIcon.svg);
      }
      .mediaControls > .pauseButton {
        top: 12.5%;
        left: 28.75%;
        background-image: URL(resources/pauseIcon.svg);
      }
      .mediaControls > .speedButton {
        top: 12.5%;
        left: 52.5%;
        background-image: URL(resources/speedIcon.svg);
      }
      .mediaControls > .speedButtonDropdown {
        height: 100%;
        width: calc(100% + 1vw);
        left: -0.5vw;
        top: calc(0.5vw); /*100% + 0.5vw*/
        background-color: RGB(255,0,255);
        z-index: -1;
      }
      @keyframes mediaDropdown {
        from {
          top: 0.5vw;
        }
        to {
          top: calc(100% + 0.5vw);
        }
      }
      @keyframes mediaRiseup {
        from {
          top: calc(100% + 0.5vw);
        }
        50% {
          top: calc(100% + 0.5vw);
        }
        to {
          top: 0.5vw;
        }
      }
      .speedButton:active ~ .speedButtonDropdown, .speedButton ~ .speedButtonDropdown:hover {
        animation: 0.5s linear 0s 1 normal forwards running mediaDropdown;
      }
      .speedButton:not(:active) ~ .speedButtonDropdown:not(:hover) {
        animation: 1s linear 0s 1 normal forwards running mediaRiseup;
      }
    </style>
  </head>
  <body>
    <div id="header">
      <img src="resources/netComLogo.svg" id="logo">
      <p id="chatKeyPreface">
        Chat Key:
      </p>
      <input type="text" id="chatKeyInput">
      </input>
      <button id="connectChat" class="purple" onclick="setChatKey(document.getElementById('chatKeyInput').value)">
        Connect
      </button>
      <button id="createChat" class="purple">
        Create
      </button>
      <button id="setUsername" class="blue" onclick="setUsername(document.getElementById('usernameInput').value)">
        Set User
      </button>
      <input type="text" id="usernameInput">
      </input>
      <div id="headerBackground">
      </div>
      <div id="createChatDropdown">
        <p id="keyPhrasePreface">
          Key Phrase:
        </p>
        <input type="text" id="keyPhraseInput">
        </input>
        <button id="keyPhraseCreateButton" class="purple" onclick="createChat(document.getElementById('keyPhraseInput').value)">
          Create
        </button>
      </div>
    </div>
    <div id="chat">
    </div>
    <div id="footer">
      <div id="messageInput">
        <textarea id="textInput"></textarea>
        <div id="fileInput">
          <button id="fileSelect" class="blue icon" onclick="document.getElementById('fileInputElement').click()">
          </button>
          <p id="fileNames">
          </p>
          <input type="file" id="fileInputElement" onchange="document.getElementById('fileNames').innerHTML = this.files[0].name">
          </input>
        </div>
      </div>
      <button id="messageSend" class="blue" onclick="writeChat(document.getElementById('textInput').value,document.getElementById('fileInputElement').files[0])">
          Send
      </button>
    </div>
  </body>
  <script>
    var chatKey = null;
    var username = null;
    function setChatKey(value) {
      chatKey = value;
      window.localStorage.setItem("chatKey",value);
      document.getElementById("chatKeyInput").value = value;
    };
    function setUsername(value) {
      username = value;
      window.localStorage.setItem("username",value);
      document.getElementById("usernameInput").value = value;
    };
    if (window.localStorage.getItem("chatKey") != null) {
      setChatKey(window.localStorage.getItem("chatKey"));  
    } else {
      setChatKey("");
    };
    if (window.localStorage.getItem("username") != null) {
      setUsername(window.localStorage.getItem("username"));
    } else {
      setUsername("Username");
    };
    /*Username colors:
    
    //Colors can change, as the chat content is updated every time the XML document is read again
    //(maximum RGB spectrum color value)/document.chat.users.getChildNodes().length (approximate)  -  This gets you the color value to increment the usernames by. Store this in a variable somewhere, and then reference it when content elements are being created
    
    var users = ["a","b","c"];
    evenly distribute amongst the color spectrum
    function rgbSpectrumColorValue(value) {
      if () { 0 <= value <= 1536
        function code 
      } else {
        return undefined;
      };
    };
    */
    
    /*
    IMPORTANT IMPORTANT IMPORTANT IMPORTANT
    Chat keys are in the format "1234#name", where 1234 is the chat number, name is the key phrase, and # is the delimiter
    -Use regex to search for the first instance of #, so that you can extract the chat number from the filename.
    --You can extract all the numbers and then compare them (find the smallest/first number that isn't there), to figure out what number to append to a newly-created key phrase
    ---The for loop checks if each integer starting from 0 is present, and repeats (number of files/chats)+1 times. This is guarenteed that it will find the first number that isn't there.
    */
    var chat = document.getElementById("chat");
    
    function createChatContent(contentType,contentData,sendingUser) {
      if (contentType === "text/plain") {
        //Text
      } else {
        if (RegExp("^image/.*").test(contentType) === true) {
          //Image
          var media = document.createElement("div");
          media.className = "media";
          chat.appendChild(media);
          var mediaContent = document.createElement("img");
          mediaContent.className = "mediaContent";
          mediaContent.src = "data:" + contentType + ";base64," + contentData; 
          media.appendChild(mediaContent);
          var mediaControls = document.createElement("div");
          mediaControls.className = "mediaControls";
          media.appendChild(mediaControls);
          var downloadButton = document.createElement("button");
          downloadButton.className = "downloadButton blue icon";
          downloadButton.onclick = "window.location = this.parentElement.parentElement.getElementsByClassName('mediaContent')[0].src";
          mediaControls.appendChild(downloadButton);
        } else {
          if (RegExp("^video/.*").test(contentType) === true) {
            //Video
            var media = document.createElement("div");
            media.className = "media";
            chat.appendChild(media);
            var mediaContent = document.createElement("video");
            mediaContent.className = "mediaContent";
            mediaContent.src = "data:" + contentType + ";base64," + contentData; 
            media.appendChild(mediaContent);
            var mediaControls = document.createElement("div");
            mediaControls.className = "mediaControls";
            media.appendChild(mediaControls);
            var playButton = document.createElement("button");
            playButton.className = "playButton purple icon";
            playButton.onclick = "this.parentElement.parentElement.getElementsByClassName('mediaContent')[0].play()";
            mediaControls.appendChild(playButton);
            var pauseButton = document.createElement("button");
            pauseButton.className = "pauseButton purple icon";
            pauseButton.onclick = "this.parentElement.parentElement.getElementsByClassName('mediaContent')[0].pause()";
            mediaControls.appendChild(pauseButton);
            //Current-time text input
            var speedButton = document.createElement("button");
            speedButton.className = "speedButton blue icon";
            speedButton.onclick = "";
            mediaControls.appendChild(speedButton);
            var speedButtonDropdown = document.createElement("div");
            speedButtonDropdown.className = "speedButtonDropdown";
            mediaControls.appendChild(speedButtonDropdown);
            var downloadButton = document.createElement("button");
            downloadButton.className = "downloadButton blue icon";
            downloadButton.onclick = "window.location = this.parentElement.parentElement.getElementsByClassName('mediaContent')[0].src";
            mediaControls.appendChild(downloadButton);
          } else {
            if (RegExp("^audio/.*").test(contentType) === true) {
              //Audio
                //mediaContent is a div. In the div is the audio element, as well as the audio visualizer element. The visualizer element is styled to fill the mediaContent div, while the audio element is styled to be invisible.
            } else {
              //File
              //This is the download/general file contentType 
            };
          };
        };
      };
    };
    createChatContent("video/X","x");
    createChatContent("audio/X","x");
    createChatContent("image/X","x");
    createChatContent("text/plain","x");
    
    function readChat() {
      //HTTP communication (using GitHub API)
      
      //End of HTTP communication
    };
    function writeChat(text,file) {
      //HTTP communication (using GitHub API)
      
      //End of HTTP communication
    };
    function createChat(keyPhrase) {
      //HTTP communication (using GitHub API)
      //get names of all chat files
      //End of HTTP communication
      //compare the numbers of the names of chat files, aquired through regex searching for the delimiter character; find out what number to give the chat key
      //create the chat key, combining the number, delimiter, and key phrase
      //HTTP communication (using GitHub API)
      //Create the XML file in the GitHub server with the key as its name, and put in the XML elements of the basic chat XML structure ("<chat>", etc. Everything that wouldn't get added by writeChat())
      //End of HTTP communication
      //Call setChatKey() with the new chat key.
    }
    
    //Chat is read and updated/refreshed every 10 milliseconds
    window.setInterval(readChat,10);
  </script>
</html>
