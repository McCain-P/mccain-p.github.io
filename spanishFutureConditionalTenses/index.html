<html>
	<head>
		<title>
			Spanish Future and Conditional Tenses
		</title>
		<style>
			.disabled, .disabled * {
				display: none;
			}
			* {
				margin: 0;
				padding: 0;
				border: none;
			}
			*::selection {
				background-color: RGB(0,128,255);
			}
			p, h1, h2, h3, h4, h5, h6, button, input {
				font-family: "Arial", sans-serif;
			}
			button:hover, input:hover, textarea:hover, button:focus, input:focus, textarea:focus, button:active {
				/*Disables the default styling applied by some browsers on elements with the "hover," "active," and "focus" pseudoclass enabled*/
				outline: none;
			}
			button:hover, #configuration > button:hover, #problems button:hover, input:hover, #problems input:hover, textarea:hover {
				/*#configuration > button:hover is used to account for the other reference of #configuration > button having a higher precedence due to being a more specific selection*/
				background-color: RGB(230,230,230);
			}
			button:active, #configuration > button:active, #problems button:active, input:focus, #problems input:focus, textarea:focus {
				/*#configuration > button:active is used to account for the other reference of #configuration > button having a higher precedence due to being a more specific selection*/
				background-color: RGB(200,200,200);
			}
			.speakable {
				background-color: RGBA(0,128,255,0.75);
				display: inline-block;
			}
			.speakable.spoken {
				/*"spoken" class is applied when the element is currently being spoken*/
				background-color: RGB(0,128,255);
			}
			body {
				background-color: RGB(255,255,255);
			}
			#header {
				background-color: RGB(255,128,0);
				height: 10vh;
				width: 100vw;
				position: fixed;
				top: 0;
				left: 0;
			}
			#title {
				color: RGB(255,255,255);
				font-size: 4vh;
				width: 100%;
				position: absolute;
				top: 50%;
				transform: translateY(-50%);
				left: 2vw;
			}
			#data {
				height: 20vh;
				width: 100vw;
				position: fixed;
				top: 0;
				left: 0;
			}
			#ratioDiv {
				background-color: RGB(255,128,0);
				height: 10vh;
				width: 25vw;
				position: absolute;
				top: 10vh;
				right: 25vw;
			}
			#ratioCorrect {
				color: RGB(255,255,255);
				font-size: 5vh;
				width: 25vw;
				text-align: center;
				position: absolute;
				top: 50%;
				left: 0;
				transform: translateY(-50%);
				white-space: nowrap;
				overflow-wrap: normal;
				word-break: keep-all;
				hyphens: none;
			}
			#problems {
				height: 70vh;
				width: 100vw;
				position: fixed;
				top: 20vh;
				left: 0;
			}
			#problems > div {
				height: 62vh;
				width: calc(100vw - 8vh);
				position: absolute;
				top: 4vh;
				left: 4vh;
			}
			#audioContainer, #audioContainer * {
				display: none;
			}
			#guide {
				overflow-x: hidden;
				overflow-y: scroll;
			}
			#guide p, #guide h1, #guide h2, #guide h3, #guide h4, #guide h5, #guide h6 {
				color: RGB(255,128,0);
			}
			#guide p {
				font-size: 2vw;
				margin: 0 0 1vw 0;
			}
			#guide h1 {
				font-size: 6vw;
				margin: 0 0 3vw 0;
			}
			#guide h2 {
				font-size: 4vw;
				margin: 0 0 2vw 0;
			}
			#guide h3 {
				font-size: 3vw;
				margin: 0 0 1.5vw 0;
			}
			#guide h4 {
				font-size: 2.5vw;
				margin: 0 0 1.25vw 0;
			}
			#guide h5 {
				font-size: 2.25vw;
				margin: 0 0 1.125vw 0;
			}
			#guide h6 {
				font-size: 2.125vw;
				margin: 0 0 1.0625vw 0;
			}
			#configuration {
				background-color: RGB(255,128,0);
				height: 10vh;
				width: 50vw;
				position: fixed;
				bottom: 0;
				right: 0;
			}
			#configuration > button {
				background-color: RGB(255,255,255);
				color: RGB(255,128,0);
				height: 8vh;
				width: 8vw;
				position: absolute;
				top: 1vh;
				font-size: 1.5vh;
				border: 0;
			}
			#selectFutureConjugationProblems {
				right: calc(5vw / 3);
			}
			#selectConditionalConjugationProblems {
				right: calc(34vw / 3);
			}
			#selectFutureTranslationProblems {
				right: 21vw;
			}
			#selectConditionalTranslationProblems {
				right: calc(92vw / 3);
			}
			#viewGuide {
				right: calc(121vw / 3);
			}
			#problems * {
				position: absolute;
			}
			#problems p, #problems input, #problems button, #problems h1, #problems h2, #problems h3, #problems h4, #problems h5, #problems h6 {
				color: RGB(255,128,0);
			}
			#problems button, #problems input {
				background-color: RGB(255,255,255);
				/*width*/
				border: thin solid RGB(255,128,0);
			}
			.problemsTitle {
				font-size: 3vw;
			}
			.problemsPrompt {
				font-size: 2vw;
			}
			.problemsResponse {
				font-size: 2vw;
			}
			.problemsSubmitButton {
				font-size: 2vw;
			}
			.problemsNextButton {
				font-size: 2vw;
			}
			.problemsCharacterSheet {
				background-color: RGB(255,128,0);
			}
			.problemsCharacterSheet > .characterButton {
				background-color: RGB(255,255,255);
				font-size: 2.5vw;
			}
		</style>
	</head>
	<body>
		<div id="header">
			<h1 id="title">
				Spanish Future and Conditional Tenses
			</h1>
		</div>
		<div id="data">
			<div id="ratioDiv">
				<p id="ratioCorrect">
					<span id="numberCorrect">0</span>/<span id="numberTotal">0</span> = <span id="percentageCorrect">0</span>%
				</p>
			</div>
		</div>
		<div id="problems">
			<div id="futureConjugationProblems" class="disabled">
				<h1 class="problemsTitle" id="problemsTitleFutureConjugation">
					Future-Tense Conjugation Problems
				</h1>
				<p class="problemsPrompt" id="problemsPromptFutureConjugation">
					Conjugate "<span class="speakable problemsPromptInfinitive" id="problemsPromptInfinitiveFutureConjugation"></span>" for "<span class="speakable problemsPromptSubject" id="problemsPromptSubjectFutureConjugation"></span>" in the future ("<span class="speakable" data-audio="futuro.mp3">futuro</span>") tense
				</p>
				<input class="problemsResponse" id="problemsResponseFutureConjugation">
				</input>
				<button class="problemsSubmitButton" id="problemsSubmitButtonFutureConjugation">
					Submit
				</button>
				<button class="problemsNextButton" id="problemsNextButtonFutureConjugation">
					Next problem
				</button>
				<div class="problemsCharacterSheet" id=""problemsCharacterSheetFutureConjugation">
					<button class="characterButton cBA">
						&#xe1;
					</button>
					<button class="characterButton cBE">
						&#xe9;
					</button>
					<button class="characterButton cBI">
						&#xed;
					</button>
					<button class="characterButton cBO">
						&#xf3;
					</button>
					<button class="characterButton cBU">
						&#xfa;
					</button>
					<button class="characterButton cBN">
						&#xf1;
					</button>
				</div>
			</div>
			<div id="conditionalConjugationProblems" class="disabled">
				<p>
					conditionalConjugationProblems
				</p>
				<!--
				Conjugate "<verb infinitive>" for "<subject>" in the conditional ("condicional") tense
				*all 3 are in speakable span
				-->
			</div>
			<div id="futureTranslationProblems" class="disabled">
				<p>
					futureTranslationProblems
				</p>
			</div>
			<div id="conditionalTranslationProblems" class="disabled">
				<p>
					conditionalTranslationProblems
				</p>
			</div>
			<div id="guide">
				<h2>
					Guide
				</h2>
				<h3>
					Conjugating future-tense verbs
				</h3>
				<p>
					Stuff
				</p>
				<h3>
					Conjugating conditional-tense verbs
				</h3>
				<p>
					Stuff
				</p>
				<h3>
					Using the website
				</h3>
				<h4>
					Selecting the problem type
				</h4>
				<p>
					Stuff
				</p>
				<h4>
					Conjugation problems
				</h4>
				<p>
					Stuff
				</p>
				<h4>
					Translation problems
				</h4>
				<p>
					Stuff
				</p>
				<h4>
					Speakable words
				</h4>
				<p>
					An example:
					<br>
					</br>
					<span class="speakable" data-audio="tener-condicional-e_l-ella-usted.mp3">tendr&#xed;a</span>
				</p>
				<h4>
					Accented characters
				</h4>
				<p>
					Stuff
				</p>
				<h4>
					Reseting the score
				</h4>
				<p>
					Stuff
				</p>
				<h3>
					Creators
				</h3>
				<h4>
					McCain Potasky
				</h4>
				<p>
					Web development
					<br>
					</br>
					Guide writing
				</p>
				<h4>
					Ian Santana
				</h4>
				<p>
					Spanish audio recordings
				</p>
			</div>
		</div>
		<div id="configuration">
			<button id="selectFutureConjugationProblems" data-problemtype="futureConjugation">
				Select Future-Tense Conjugation Problems
			</button>
			<button id="selectConditionalConjugationProblems" data-problemtype="conditionalConjugation">
				Select Conditional-Tense Conjugation Problems
			</button>
			<button id="selectFutureTranslationProblems" data-problemtype="futureTranslation">
				Select Future-Tense Translation Problems
			</button>
			<button id="selectConditionalTranslationProblems" data-problemtype="conditionalTranslation">
				Select Conditional-Tense Translation Problems
			</button>
			<button id="viewGuide" data-problemtype="guide">
				View Guide
			</button>
		</div>
		<div id="audioContainer">
			<audio src="audio/futuro.mp3">
			</audio>
			<audio src="audio/condicional.mp3">
			</audio>
			<audio src="audio/yo.mp3">
			</audio>
			<audio src="audio/e#l-ella-usted.mp3">
			</audio>
			<audio src="audio/ellos-ellas-ustedes.mp3">
			</audio>
			<audio src="audio/tu#.mp3">
			</audio>
			<audio src="audio/nosotros.mp3">
			</audio>
			<audio src="audio/vosotros.mp3">
			</audio>
		</div>
	</body>
	<script>
		//Error handling
		window.onerror = function(message, src, lineN, columnN, error) {
			window.alert("Error: " + message + " - " + src + ", Line " + lineN + ", Column " + columnN);
		};
		function selectProblemType(e) {
			var enabledProblem = e.target.dataset.problemtype;
			if (e.target.dataset.problemtype !== "guide") {
				enabledProblem += "Problems";
			};
			var problems = document.getElementById("problems").children;
			for (var i = 0; i < problems.length; i++) {
				if (problems[i].id !== enabledProblem) {
					problems[i].classList.add("disabled");
				} else {
					problems[i].classList.remove("disabled");
				};
			};
		};
		var buttons = document.getElementById("configuration").children;
		for (var i = 0; i < buttons.length; i++) {
			buttons[i].addEventListener("click", selectProblemType);
		};
		var verbs = ["tener","poner","valer","salir","venir","poder","caber","haber","saber","querer","decir","hacer","abrir","correr","dar","jugar","llegar","llamar","leer","ir","hablar","vivir","ver","tomar","trabajar","ser","empezar","pagar","mirar","llevar","creer","deber"];
		var irregularBoundaryIndex = 11;
		var irregulars = ["tendr","pondr","valdr","saldr","vendr","podr","cabr","habr","sabr","querr","dir","har"];
		var subjects = ["yo","t&#xfa;","&#xe9;l/ella/usted","nosotros","vosotros","ellos/ellas/ustedes"];
		var subjectsEnglish = ["I","you","he/she/it","we","you all","they"];
		var subjectEndingsFuture = ["&#xe9;","&#xe1;s","&#xe1;","emos","&#xe9;is","&#xe1;n"];
		var subjectEndingsConditional = ["&#xed;a","&#xed;as","&#xed;a","&#xed;amos","&#xed;ais","&#xed;an"];
		var englishVerbTranslations = ["have","put","be worth","leave","come","be able to","fit","have","know","want","say","do","open","run","give","play","arrive","call","read","go","speak","live","see","take","work","be","begin","pay","watch","take","believe","owe"];
		var sanitizedCharacters = [["a&#x301;","&#xe1;"],["e&#x301;","&#xe9;"],["i&#x301;","&#xed;"],["o&#x301;","&#xf3;"],["u&#x301;","&#xfa;"],["A&#x301;","&#xe1;"],["E&#x301;","&#xe9;"],["I&#x301;","&#xed;"],["O&#x301;","&#xf3;"],["U&#x301;","&#xfa;"],["&#xc1;","&#xe1;"],["&#xc9;","&#xe9;"],["&#xcd;","&#xed;"],["&#xd3;","&#xf3;"],["&#xda;","&#xfa;"],["A","a"],["B","b"],["C","c"],["D","d"],["E","e"],["F","f"],["G","g"],["H","h"],["I","i"],["J","j"],["K","k"],["L","l"],["M","m"],["N","n"],["O","o"],["P","p"],["Q","q"],["R","r"],["S","s"],["T","t"],["U","u"],["V","v"],["W","w"],["X","x"],["Y","y"],["Z","z"]];
		function randomVerb(tense, infinitive, subject, conjugation, englishTranslation, infinitiveEnglishTranslation) {
			/*
			Input/Output = {tense, infinitive, subject, conjugation, englishTranslation, infinitiveEnglishTranslation}
			
			tense:
				Input: Number; tense to be used
				Output: Number; tense used
				tense = 0 -> future
				tense = 1 -> conditional
			infinitive:
				Input: Boolean; if the infinitive should be returned
				Output: String; verb infinitive
					If input = false, an empty string is returned
			subject:
				Input: Boolean; if the subject should be returned
				Output: String; subject
					If input = false, an empty string is returned
			conjugation:
				Input: Boolean; if the conjugated verb should be returned
				Output: String; the conjugated verb
					If input = false, an empty string is returned
			englishTranslation:
				Input: Boolean; if the English translation of the conjugated verb should be returned
				Output: String; the English translation of the conjugated verb
					If input = false, an empty string is returned
			infinitiveEnglishTranslation:
				Input: Boolean; if the English translation of the verb infinitive should be returned
				Output: String; the English translations of the verb infinitive, without the "to" prefix
					If input = false, an empty string is returned
			*/
			var data = [tense, "", "", "", "", ""];
			var subjectNumber = Math.round(Math.random() * 5);
			if (subject) {
				data[2] = subjects[subjectNumber];	
			};
			if (infinitive || conjugation || englishTranslation || infinitiveEnglishTranslation) {
				var verbNumber = 0;
				var regular = true;
				if (Math.random() < 0.25) {
					verbNumber = Math.round(Math.random() * irregulars.length);
					regular = false;
				} else {
					verbNumber = Math.round(Math.random() * (verbs.length - irregularBoundaryIndex - 2)) + irregularBoundaryIndex + 1
				};
				if (infinitive) {
					data[1] = verbs[verbNumber];
				};
				if (infinitiveEnglishTranslation) {
					data[5] = englishVerbTranslations[verbNumber];
				};
				if (conjugation) {
					var verb = "";
					if (regular) {
						verb = data[1];
					} else {
						verb = irregulars[verbNumber];
					};
					if (tense === 0) {
						verb += subjectEndingsFuture[subjectNumber];
					} else {
						verb += subjectEndingsConditional[subjectNumber];
					};
					data[3] = verb;
				};
				if (englishTranslation) {
					var tensePhrase = "";
					if (tense === 0) {
						tensePhrase = "will";
					} else {
						tensePhrase = "would/could";
					};
					data[4] = subjectsEnglish[subjectNumber] + " " + tensePhrase + " " + englishVerbTranslations[verbNumber];
				};
			};
			return data;
		};
		function inputSanitization(input) {
			var sanitized = input;
			for (var i = 0; i < sanitizedCharacters.length; i++) {
				sanitized = sanitized.replace(new RegExp(sanitizedCharacters[i][0], "g"), sanitizedCharacters[i][1]);
			};
			return sanitized;
		};
		//Adding <audio> elements for the infinitives and conjugation permutations of the verbs
		var audioContainer = document.getElementById("audioContainer");
		var audioFileType = "mp3";
		for (var i = 0; i < verbs.length; i++) {
			var audioElement = document.createElement("audio");
			audioElement.src = "audio/" + verbs[i];
			audioContainer.appendChild(audioElement);
			for (var j = 0; j < 6; j++) {
				var subject = subjects[j];
				var characterSubstitutions = [["\/","-"],["&#xe1;","a_"],["&#xe9;","e_"],["&#xed;","i_"],["&#xf3;","o_"],["&#xfa;","u_"],["&#xf1;","n_"]];
				for (var k = 0; k < characterSubstitutions.length; k++) {
					subject = subject.replace(new RegExp(characterSubstitutions[k][0], "g"), characterSubstitutions[k][1]);
				};
				var audioElement = document.createElement("audio");
				audioElement.src = "audio/" + verbs[i] + "-futuro-" + subject + "." + audioFileType;
				audioContainer.appendChild(audioElement);
				var audioElement = document.createElement("audio");
				audioElement.src = "audio/" + verbs[i] + "-condicional-" + subject + "." + audioFileType;
				audioContainer.appendChild(audioElement);
			};
		};
		//Defining the function that occurs when an element with a class of "speakable" is clicked, and adding a "click" event listener that refers to that function on all elements with a class of "speakable"
		function speak(e) {
			var element = e.target;
			element.classList.add("spoken");
			for (var i = 0; i < audioContainer.children.length; i++) {
				var audioFileElement = audioContainer.children[i];
				if (new RegExp("(.*\\/)?" + element.dataset.audio.slice(0, -1 * (audioFileType.length + 1)) + "\\." + audioFileType).test(audioFileElement.src)) {
					audioFileElement.addEventListener("ended", function() {
						element.classList.remove("spoken");
					});
					var promise = audioFileElement.play();
					console.log(promise);
					break;
				};
			};
		};
		var speakableElements = document.getElementsByClassName("speakable");
		for (var i = 0; i < speakableElements.length; i++) {
			speakableElements[i].addEventListener("click", speak);
		};
	</script>
</html>
